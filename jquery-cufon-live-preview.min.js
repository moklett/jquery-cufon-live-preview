var CufonLivePreview=function(c){var b=function(a,e){this.textarea=a;this.settings=c.extend({fonts:CufonLivePreview.fontRegistry,fontSizes:"12,14,18,24,30,36,48,60,72".split(","),defaultFontSize:null,defaultFont:null},e);b.addWidget(this);this.generateHTML()};b.widgets=[];b.defaultContent="Enter your text here";b.addWidget=function(a){b.widgets.push(a);a.widgetId="clpwidget_"+b.widgets.length.toString()};b.prototype.content=function(){var a=c.trim(this.textarea.val()),a=a.replace(/\n/g,"<br>");0===
a.length&&(a=b.defaultContent,this.textarea.val(a));return a};b.prototype.generateHTML=function(){this.root=c('<div class="clpwidget" id="'+this.widgetId+'"/>');this.toolbar=c('<div class="clpwidget_toolbar"/>');this.toolbarFontSelector=c('<select class="clpwidget_font_select"/>');this.toolbarSizeSelector=c('<select class="clpwidget_font_size_select"/>');this.toolbarEditButton=c('<button class="clpwidget_edit_button">Change Text</button>');this.toolbarUpdateButton=c('<button class="clpwidget_save_button">Update</button>').hide();
this.previewPane=c('<div class="clpwidget_preview"/>').html(this.content());this.textarea.addClass("clpwidget_editor");this.root.append(this.toolbar.append(this.toolbarFontSelector.append(this.htmlFontSelectOptions()),this.toolbarSizeSelector.append(this.htmlFontSizeSelectOptions()),this.toolbarEditButton,this.toolbarUpdateButton),this.previewPane)};b.prototype.htmlFontSelectOptions=function(){var a=[];0==this.settings.fonts.length?a.push('<option value="">No Fonts Loaded</option>'):c.each(this.settings.fonts,
function(b,d){var f=d,g=d;c.isArray(d)&&(f=d[0],g=d[1]);a.push('<option value="'+g+'">'+f+"</option>")});return c(a.join(""))};b.prototype.htmlFontSizeSelectOptions=function(){var a=[];c.each(this.settings.fontSizes,function(b,c){a.push('<option value="'+c+'">'+c+"</option>")});return c(a.join(""))};b.prototype.init=function(){this.textarea.before(this.root);this.root.append(this.textarea);this.textarea.hide();this.toolbarFontSelector.val(this.computeDefaultFont());this.toolbarSizeSelector.val(this.computeDefaultFontSize());
this.preview();var a=this;this.toolbarSizeSelector.change(function(){a.preview()});this.toolbarFontSelector.change(function(){a.preview()});this.previewPane.click(function(){a.edit()});this.toolbarEditButton.click(function(){a.edit()});this.toolbarUpdateButton.click(function(){a.update()})};b.prototype.computeDefaultFontSize=function(){return null==this.settings.defaultFontSize?this.settings.fontSizes[Math.floor(this.settings.fontSizes.length/2)]:this.settings.defaultFontSize.toString()};b.prototype.computeDefaultFont=
function(){return null==this.settings.defaultFont?this.settings.fonts[0]:this.settings.defaultFont};b.prototype.preview=function(){var a=this.toolbarFontSelector.val(),b=this.toolbarSizeSelector.val();Cufon.replace(this.previewPaneSelector(),{fontFamily:a,fontSize:b+"px"})};b.prototype.edit=function(){this.previewPane.hide();this.textarea.show();this.textarea.height(Math.max(50,this.previewPane.height()));this.toolbarEditButton.hide();this.toolbarUpdateButton.show()};b.prototype.update=function(){this.previewPane.show();
this.textarea.hide();this.toolbarEditButton.show();this.toolbarUpdateButton.hide();this.previewPane.html(this.content());this.preview()};b.prototype.previewPaneSelector=function(){return"#"+this.root.attr("id")+" .clpwidget_preview"};return{Widget:b,fontRegistry:[],registerFont:function(a){CufonLivePreview.fontRegistry.push(a.face["font-family"]);Cufon.registerFont(a);return a}}}(jQuery);
(function(c){c.fn.cufonLivePreview=function(b){return this.each(function(a,e){"TEXTAREA"==e.nodeName&&(new CufonLivePreview.Widget(c(e),b)).init()})}})(jQuery);
